@using GridMvc
@using GridMvc.Filtering
@using GridMvc.Html
@using GridMvc.Sorting
@model IEnumerable<Bauhaus.Models.Contact>

@{
    ViewBag.Title = "Contact List";
}
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div id="contactsGrid">
                @Html.Partial("_ContactsGrid", Model)
            </div>
        </div>
        <div class="col-md-2">
            <button class="btn btn-default" type="button" data-toggle="modal" data-target="#createModal">
                <i class="fa fa-user fa-5x"></i><br />
                Create Contact
            </button>
        </div>
    </div>
</div>
<!-- Create Contact Modal -->
<div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="createContactLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="CreateContactLabel"><i class="fa fa-edit fa-2x"></i> Create Contact</h4>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <label>Area</label><br />
                        <input type="text" id="createArea" />
                    </div>
                    <div class="form-group">
                        <label>Name</label><br />
                        <input type="text" id="createName" />
                    </div>
                    <div class="form-group">
                        <label>Tel.</label><br />
                        <input type="tel" id="createTelephone" />
                    </div>
                    <div class="form-group">
                        <label>Email</label><br />
                        <input type="email" id="createEmail" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="createContact">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Contact Modal -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editContactLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="EditContactLabel"><i class="fa fa-edit fa-2x"></i> Edit Contact</h4>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <label>Area</label><br />
                        <input type="text" id="editArea" />
                    </div>
                    <div class="form-group">
                        <label>Name</label><br />
                        <input type="text" id="editName" />
                    </div>
                    <div class="form-group">
                        <label>Tel.</label><br />
                        <input type="tel" id="editTelephone" />
                    </div>
                    <div class="form-group">
                        <label>Email</label><br />
                        <input type="email" id="editEmail" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="saveEdit">Save changes</button>
            </div>
        </div>
    </div>
</div>

<script>
    var contactID = 0;
    $(function () {
        // SAVE NEW CONTACT
        $("#createContact").click(function () {
            $.post("@Url.Action("Create","Contact")", {
                area: $("#createArea").val(),
                name: $("#createName").val(),
                telephone: $("#createTelephone").val(),
                email: $("#createEmail").val()
            }, function (data) {
                if (data.Status == 1)
                {
                    $("#contactsGrid").animate({ opacity: 0 });
                    $("#contactsGrid").load("@Url.Action("GetContactsGrid")").animate({ opacity: 1 });
                }
                    
                else
                    displayAlert("warning", data.Message);
            });
        });

        // LOAD EDIT CONTACT ->>>>>>>>>> CONTACTSGRID PARTIAL VIEW

        // SAVE EDIT
        $("#saveEdit").click(function () {
            $.post("@Url.Action("Update")", {
                id: contactID,
                area: $("#editArea").val(),
                name: $("#editName").val(),
                telephone: $("#editTelephone").val(),
                email: $("#editEmail").val()
            }, function (data) {
                if (data.Status != 1)
                    displayAlert("warning", data.Message);
                else
                    $("#contactsGrid").load("@Url.Action("GetContactsGrid")").fadeIn();
            });
        });

        // REMOVE CONTACT ->>>>>>>>> CONTACTSGRID
    });
</script>